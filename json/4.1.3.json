[{"id":"/sicpjs/4.1.3","tag":"TITLE","body":"4.1.3  \n    Evaluator Data Structures"},{"tag":"TEXT","id":"#p1","child":[{"body":"\n    In addition to defining the \n    representation of components,\n    the evaluator implementation must also define the data structures that the\n    evaluator manipulates internally, as part of the execution of a\n    program, such as the representation of\n    functions\n    and environments and the representation of true and false.\n  ","tag":"#text"}]},{"tag":"SUBHEADING","id":"#h1","child":[{"body":"Testing of predicates","tag":"#text"}]},{"tag":"TEXT","id":"#p2","child":[{"body":"\n\tIn order to limit the predicate expressions of conditionals to proper\n\tpredicates (expressions that evaluate to a boolean value) as we do throughout\n\tthis book, we insist here that the function \n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_truthy"},{"body":" gets applied only to\n\tboolean values, and we accept only the boolean value\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"true"},{"body":" to be truthy.\n      The opposite of\n      ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_truthy"},{"body":" is called\n      ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_falsy"},{"body":" and will come in handy in\n      the register machine implementations in\n      sections ","tag":"#text"},{"tag":"REF","body":"5.4.1","href":"/sicpjs/5.4.1"},{"body":" and\n      sections ","tag":"#text"},{"tag":"REF","body":"5.5.2","href":"/sicpjs/5.5.2"},{"body":".","tag":"#text"},{"tag":"FOOTNOTE_REF","id":"#footnote-link-1","body":"1","href":"/sicpjs/4.1.3#footnote-1"},{"tag":"SNIPPET","latex":false,"id":1,"eval":true,"prependLength":0,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0KAnIigCwE8AKAB4BKUAG9coSaDYBTCkTb0mzAEY0aAGxkBDEoJESpRqQH5QAw8aMAuUDLZsabQQBpQAIjWad9GQIAOMpQyACZusmQyVABuoe5CANy4AL6EpJS0SiwE2hqM-MJi0nIK9ACEDCzsnLz6CaCpuMrV3Pw5eTKJoCCgjFw0RBohxfKKoO2MMqAqQdpEk6B0Gjyg1VNMqxytQA","body":"function is_truthy(x) {\n    return is_boolean(x) \n           ? x\n           : error(x, \"boolean expected, received\");\n}\nfunction is_falsy(x) { return ! is_truthy(x); } "}]},{"tag":"SUBHEADING","id":"#h2","child":[{"body":"Representing\n    functions","tag":"#text"}]},{"tag":"TEXT","id":"#p3","child":[{"body":"\n    To handle primitives, we assume that we have available the following\n    functions:","tag":"#text"},{"tag":"UL","child":[{"tag":"LI","child":[{"tag":"JAVASCRIPTINLINE","body":"apply_primitive_function("},{"tag":"META","body":"fun"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"args"},{"tag":"JAVASCRIPTINLINE","body":")"},{"body":"\n\n\tapplies the given primitive\n\tfunction\n\tto the argument values in the list ","tag":"#text"},{"tag":"META","body":"args"},{"body":" and returns the result of\n\tthe application.\n      ","tag":"#text"}]},{"tag":"LI","child":[{"tag":"JAVASCRIPTINLINE","body":"is_primitive_function("},{"tag":"META","body":"fun"},{"tag":"JAVASCRIPTINLINE","body":")"},{"body":"\n\n\ttests whether\n\t","tag":"#text"},{"tag":"META","body":"fun"},{"body":"\n        is a primitive\n        function.","tag":"#text"}]}]},{"body":"\n\n    These mechanisms for handling primitives are further described in\n    section ","tag":"#text"},{"tag":"REF","body":"4.1.4","href":"/sicpjs/4.1.4"},{"body":".\n  ","tag":"#text"}]},{"tag":"TEXT","id":"#p4","child":[{"body":"\n    Compound\n    functions\n    are constructed from parameters,\n    function\n    bodies, and environments using the constructor \n    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"make_function"},{"body":":\n      ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":2,"eval":true,"prependLength":13,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0KBDAcw4FMATZgDZMKACjI0AtgAc63EhQA0oCgAturTgEpQAb1ygDoAE7cKRI-SbMpbKkbGSZJORW0AyN6DVteD6bPltAF4Q5TUNDgBuXABffGJyajpQOTIBGkYqEg5mOQA3OzoJFxF87T1DY1NzenYqAVKSPM1ouITKWnoCO0YKZgIjNmLG5t19QxMzCy9uHxGW2NxxEl6w9W5pCgBPXKbCkmL5UCDQEiIBAWjCUg7kiTYAa3V2pJIRG0Hiim4jRiUAIxovC2SjKY0qkxqoCEvREACJxP5SPwXp04QpxpUsViPkNTD8-qBAcDQU0Fm0bq8GCxETJkf1KZ0RARypiqlNLCx2Fw+IJhMylAjHDR6ai6HDyddEp1QGKSNY2J98b9mayIdVpjC+iYCALQBhJXLZYy6MxiVtVeCJhr6FrmDq9QAmQ0mrqu3YFIxFEosq0GSGa4T27i6ghKbCSpZ0VYSHZGk5s+5PBnSugiNmVLXwgAe6NAcK2Eox2IMWbhAflvTY30OFDzH0Y3BzoAA1KAtpEJZpiyXVOtNjt8vtawteEwpAI2BarLSRSQUa6RLGU7cSJpR+PJxa5Qqld8Vcu5evomPGBOp8z3eal3HXcfcKfz9v3UOvQcSoe7y0gA","body":"function make_function(parameters, body, env) {\n    return list(\"compound_function\",\n                parameters, body, env);\n}\nfunction is_compound_function(f) {\n    return is_tagged_list(f, \"compound_function\");\n}\nfunction function_parameters(f) {\n    return list_ref(f, 1);\n}\nfunction function_body(f) {\n    return list_ref(f, 2);\n}\nfunction function_environment(f) {\n    return list_ref(f, 3);\n} "}]},{"tag":"SUBHEADING","id":"#h3","child":[{"body":"Representing return values","tag":"#text"}]},{"tag":"TEXT","id":"#p5","child":[{"body":"\n\tWe saw in section ","tag":"#text"},{"tag":"REF","body":"4.1.1","href":"/sicpjs/4.1.1"},{"body":" that the\n\tevaluation of a sequence terminates when a return statement\n\tis encountered, and that the evaluation of a function application needs\n\tto return the value ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"undefined"},{"body":" if\n\tthe evaluation of the function body does not encounter a\n\treturn statement. In order to recognize that a value resulted from a\n\treturn statement, we introduce ","tag":"#text"},{"tag":"EM","child":[{"body":"return values","tag":"#text"}]},{"body":" as evaluator data\n\tstructures.\n\t","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":3,"eval":true,"prependLength":13,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0KBDAcw4FMATZgDZMKACjI0AtgAc63EhQA0oCgAturTgEpQAb1ygDoAE7cKRI-SbMpbKkbGSZJORW0AyN6DVteD6bPltAF4Q5TUNDgBuXABffGJyajpQOTIBGkYqEg5mOQA3OzoJFxF87T1DY1NzenYqAVKSPM1ouITKWnoCO0YKZgIjNmLG5t19QxMzCy9uHxGW2NxxEl6w9W5pCgBPXKbCkmL5UCDQEiIBAWjCUg7kiTYAa3VJmuY8tgEibgd5F3LxgwvaZCXoiABEQJIbw+XzBSmWFD+rWuiU6DBYkOhn2+72x-0qkPRER4-BBolxXyUEOqFixsIWbRuSXomIp6gRJTZ+ImNPo3l8dQaXIZ+GWqwkO1ZMO4x1A9yezCl2JEKAATAteEwpAI2FsRFYlV8RBLFby6dxNBqtTq9Yb2XREfJjZKzcLIkA","body":"function make_return_value(content) {\n    return list(\"return_value\", content);\n}\nfunction is_return_value(value) {\n    return is_tagged_list(value, \"return_value\");\n}\nfunction return_value_content(value) {\n    return head(tail(value));\n} "}]},{"tag":"SUBHEADING","id":"#h4","child":[{"body":"Operations on Environments","tag":"#text"}]},{"tag":"TEXT","id":"#p6","child":[{"body":"\n    The evaluator needs operations for\n    \n    manipulating environments.  As explained\n    in section ","tag":"#text"},{"tag":"REF","body":"3.2","href":"/sicpjs/3.2"},{"body":", an environment is a\n    sequence of frames, where each frame is a table of bindings that associate\n    symbols\n    with their corresponding values.  We use the following operations for\n    manipulating environments:\n    ","tag":"#text"},{"tag":"UL","child":[{"tag":"LI","child":[{"tag":"JAVASCRIPTINLINE","body":"lookup_symbol_value("},{"tag":"META","body":"symbol"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"env"},{"tag":"JAVASCRIPTINLINE","body":")"},{"body":"\n\n\t  returns the value that is bound to\n\t  ","tag":"#text"},{"tag":"META","body":"symbol"},{"body":" in the environment\n\t  ","tag":"#text"},{"tag":"META","body":"env"},{"body":", or signals an error if\n\t  ","tag":"#text"},{"tag":"META","body":"symbol"},{"body":" is unbound.\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"tag":"JAVASCRIPTINLINE","body":"extend_environment("},{"tag":"META","body":"symbols"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"values"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"base-env"},{"tag":"JAVASCRIPTINLINE","body":")"},{"body":"\n\n\t    returns a new environment, consisting of a new frame in which the\n\t    symbols in the list ","tag":"#text"},{"tag":"META","body":"symbols"},{"body":"\n\t    are bound to the corresponding elements in the list\n\t    ","tag":"#text"},{"tag":"META","body":"values"},{"body":", where the enclosing\n\t    environment is the environment\n\t    ","tag":"#text"},{"tag":"META","body":"base-env"},{"body":".\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value("},{"tag":"META","body":"symbol"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"value"},{"tag":"JAVASCRIPTINLINE","body":","},{"tag":"META","body":"env"},{"tag":"JAVASCRIPTINLINE","body":")"},{"body":"\n\n\t    finds the innermost frame of\n\t    ","tag":"#text"},{"tag":"META","body":"env"},{"body":"\n\t    in which ","tag":"#text"},{"tag":"META","body":"symbol"},{"body":"\n\t    is bound, and changes that frame\n\t    so that\n\t    ","tag":"#text"},{"tag":"META","body":"symbol"},{"body":"\n\t    is now bound to \n\t    ","tag":"#text"},{"tag":"META","body":"value"},{"body":", or signals an\n\t    error if ","tag":"#text"},{"tag":"META","body":"symbol"},{"body":" is\n\t    unbound.\n\t  ","tag":"#text"}]}]}]},{"tag":"TEXT","id":"#p7","child":[{"body":"\n    To implement these operations we\n    \n    represent an environment as a list of\n    frames.  The enclosing environment of an environment is the\n    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"tail"},{"body":"\n    of the list.  The empty environment is simply the empty list.\n    ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":4,"eval":true,"prependLength":0,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0AU3IBsaBnKkgcwH0mA3KgCc6AWyYUAFAICUoAN65Qy0EIYUiQ+hQCGVZtJL8ZAblwBfQqUq16BYWwo8CQneMPGFSlWo1bQABYMOgAmHqYWuGR0jqAUQXyiAA4UAJ58RsJiEqAAvKAkRMzMZrjxDIkp6QJZJOIkFCZAA","body":"function enclosing_environment(env) {\n    return tail(env);\n}\nfunction first_frame(env) {\n    return head(env);\n}\nconst the_empty_environment = null; "},{"body":"\n    Each frame of an environment is represented as a pair of lists: a list\n    of the\n    names\n    bound in that frame and a list of the associated\n    values.","tag":"#text"},{"tag":"FOOTNOTE_REF","id":"#footnote-link-2","body":"2","href":"/sicpjs/4.1.3#footnote-2"},{"tag":"SNIPPET","latex":false,"id":5,"eval":true,"prependLength":0,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0AWwEMBrAUwH0CAnJhtgBQBnAJ4MARjQA2QgDSgAbkylE2QgJSgA3rlB7Q3NhSLd6AByZVuwsZJnylKteoDcuAL6FSlWvR59OUQlpIQF-fk0tfVBdfUNjU1AACzYmABMw3gi3T2JyajpQcM5HVVDiyOjYvXiTegpLKUyA1w98MjohCkYRLiy2UABeRlZOYoEpKi6BACIADxn5GZEZ9XlJ6Yx5ACZ1VuKOILtQhl6KlyA","body":"function make_frame(symbols, values) {\n    return pair(symbols, values);\n}\nfunction frame_symbols(frame) {    \n    return head(frame);\n}\nfunction frame_values(frame) {    \n    return tail(frame);\n} "}]},{"tag":"TEXT","id":"#p8","child":[{"body":"\n    To extend an environment by a new frame that associates\n    symbols\n    with values, we make a frame consisting of the list of\n    symbols\n    and the list of values, and we adjoin this to the environment.  We signal\n    an error if the number of\n    symbols\n    does not match the number of values.\n    ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":6,"eval":true,"prependLength":19,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0AU3IBsaBnKkgcwH0mA3KgCc6AWyYUAFAICUoAN65Qy0EIYUiQ+hQCGVZtJL8ZAblwBfQqUq16BYWwo8CQneMPGFSlWo1bQABYMOgAmHqYWuGR0jqAUQXyiAA4UAJ58RsJiEqAAvKAkRMzMZlbk1HSgojoA1gzOru5sqaIARjTMbAA0oPw6zEQMbHKKKqrqmvRJekKSzW0d3b39g8NmlsTltqAubvXz7Z2Su+IjY97KvpOBwWEnDBEb1hV2jfV9A0PHb2cqF+N+bR6Az3R74TY2SoMAAeFCYIQyghEJHEJCkB0WPQ+S1aOjY9VkXjGV38zCYXHicxah2GeVy+TJ3Ep2Jk-zGKgA-KBpsJJNU6g09lSFp0sf1hj1cfjEaz2XKAFygRkUgLCmlyAA8SvJzPFsrlYy5DCEIlmACIKDQaFUdCRUqAdEIuERURQ2KA2EQkklmFQGCFFWbQABqUBsg0GxxCThcKgEVJqxZyUNmnpB0PhiPsqMxuMJln6rOK42myQWq07BgAdwdTpdEndnu9vv9gZDYaznZz3Dzic6ydAqcH7czneU3dj8ckBfW+BhcJICIEWRREkkvscZehQ7NqR3AC8zTIuqOxxupBgegAmHrYY+nzvxAnJNKIleu0xAA","body":"function extend_environment(symbols, vals, base_env) {\n    return length(symbols) === length(vals)\n           ? pair(make_frame(symbols, vals), base_env)\n           : error(pair(symbols, vals), \n                   length(symbols) < length(vals)\n                   ? \"too many arguments supplied\"\n                   : \"too few arguments supplied\");\n} "},{"body":"\n\tThis is used by ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"apply"},{"body":" in\n\tsection ","tag":"#text"},{"tag":"REF","body":"4.1.1","href":"/sicpjs/4.1.1"},{"body":" to bind the\n\tparameters of a function to its arguments. \n      ","tag":"#text"}]},{"tag":"TEXT","id":"#p9","child":[{"body":"\n    To look up a\n    symbol\n    in an environment, we scan the list of\n    symbols\n    in the first frame.  If we find the desired\n    symbol,\n    we return the corresponding element in the list of values. If we do not\n    find the\n    symbol\n    in the current frame, we search the enclosing environment, and so on.\n    If we reach the empty environment, we signal an\n    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"\"Unbound name\""},{"body":"  \n    error.\n    ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":7,"eval":true,"prependLength":31,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0AU3IBsaBnKkgcwH0mA3KgCc6AWyYUAFAICUoAN65Qy0EIYUiQ+hQCGVZtJL8ZAblwBfQqUq16BYWwo8CQneMPGFSlWo1bQABYMOgAmHqYWuGR0jqAUQXyiAA4UAJ58RsJiEqAAvKAkRMzMZlbk1HSMAB4UTCEZgiIk4iRSbKmiAEY0zGwANKD8Or0DnTpsDA1yiiqq6pr0zExc8ZLtXT1scrk7oEvcq0O9Mt6zZwD8oEl6QpKiOgDWky5uDGsd3SODw1uj45OyU5nFQALj2y1W60+W1AAB5wQcApIjlsgcDQJcGEIRLcAEQUGg0UD3EipUA6IRcIgtChsUBsIhJJLMKgMEJg3GgADUoDR6PRjiEnC4VAIqXeG2O3NAuIGnJ5fP5Z0FwtF4pRMhOSuUYKxOMk+MJoAIDAA7uTKdSJHSGUyWWyOdLFdrlCruGqJdC5DzZTKnS7+W6RWLkT9NWZLGUbJV7k9nK53FDNgMjkQGDCZj55v5rsJPcnvsw01sI1GKnYE5Mk71JC9xNNZkDfAtAsEwnWGBFLMRyrZjZWeKn07XKw2VE3s9o9AYO138D3o4tCQ9GTxq4Phmn88wBrIvLMF+XGEYeKwaElwvv0Ye+2wyDoSNv+oWM87Zs3-FQ2DxCsUn1qA2BTETzPC8mDIVgOG4BosmaCRwgAwDZjBas8l2IJQn-N9tUuDCwg1bClRQ+9H10fR-wGMiDA1CJ+UsflRVADw0PyeIAWSNIYKaGlpkIxhsRoW5qzlUhulIEICleXFaPRcxGF6Bgr21aISFiDs8mNBwnA7cIzADD96DvB8R1eNcPk2Ez6z6PiAw7Dci2HWcZOBeiVFc5QDOPfhT0JMCjDnKIYgoYl0gEWCaTyIEGBqOouOyVpJBZRwDSqX1cVSNKAC9pOspClSSqQMAGAAmAZsBkXK8vRNjEhSULMm4iQIlwM8VySMzJXsrdcVSgZRHqxp4ooUwgA","body":"function lookup_symbol_value(symbol, env) {\n    function env_loop(env) {\n        function scan(symbols, vals) {\n            return is_null(symbols)\n                   ? env_loop(enclosing_environment(env))\n                   : symbol === head(symbols)\n                   ? head(vals)\n                   : scan(tail(symbols), tail(vals));\n        }\n        if (env === the_empty_environment) {\n            error(symbol, \"unbound name\");\n        } else {\n            const frame = first_frame(env);\n            return scan(frame_symbols(frame),\n                        frame_values(frame));\n        }\n    }\n    return env_loop(env);\n} "}]},{"tag":"TEXT","id":"#p10","child":[{"body":"To assign \n      a new value to a symbol in a specified environment, we scan\n      for the symbol, just as in \n      ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"lookup_symbol_value"},{"body":",\n      and change the corresponding value when we find it.\n      ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":8,"eval":true,"prependLength":457,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuRQAzAVwDsBjAFwEsB7MgZ2ICc6BbCGeJVTTfKUq0GoAKYA3AIYAbElKpiAFBQ4AHBmLJUANOLISAlKADeuUBdAsxVEizKgajAPoyailrJXrN2w+ctAywB+UDcPWWdpOWVVdg0yLSp-INSALkcXMil2WJ9EvwDUkLC6OgBrEjVnRgBPdgAjOhko2RJlOsbm5zoiZ2zc73jfZL0tIyLi0AynZyk1NTcKBXoyIYSklKmLUPnF2qVJNoVlIWpV5zEADzVrRkZV9ZHDMYMXye3Ut0YqHr7o9qMJRSFgAc0uNzuDwYQLiGz8ryMW22MxcdDUYk8VDoLGccQaNGyIjWcOeH1SoSOchOSnRmIUOLxHAJRIu2LmCyWKwYTwKo3Jn1S42RU1RTLIABN3KsvKS+SLipTouKpcTZfkkoiFelMq4cg0JVIIbcxPdHnLNgLAqF2FJymJnGdiUoZPrDc41CCcjZMTV6k0ZLCNQirYKpq7Gu6mhKDhaEfoJoKxYwxABHdqUPLDeWhnbiZUp9NaCgdNMZks1KgnXLaIPZzZa3PTXUNGR0CjlXmWwVKyKt9uduO6BPaoJi6y2eyV6tJLuFHv5yITuxkaeKGtUOfD4VNsVOi4SsQUV1Y83B5JN3vUxRKfcMZyH4-OdmqJhV7QPo8yLcvEe73WPie3Ikueo7WouLSAV6zpDo2Sa6lIZqgmQG4-peEFzEhKGzrBf7wZibAsFuegAETkOUZB0AA7g4dTaFIVygAAtExEHyIoJGGAA3LgAC+gjkOcoh7DIBxCHoIKgowxhmIENBEKASizLcNDsNKEgOneaxCIYMlWsu9igCJtQeiwqnqZpgnOuJRlgtJPGBLx4iBmIjgKUpLikuQEqOlZjw6XpUyvj8VimiQMhUKAAC8bE0lpzjRmJ5DvGGqXFNciiSpcBg0Gw2HaEoTZpYK8Wep4uQeECOk6EVxXbJJjA1XVzWWPF4y5QwqEBdx+k2CuuoGauALKHc4UXsVoSDa0MTiplm6jRFYHFBk3liEQhJiBKDmWE5YguaYVoETit7kKR5GUTRxB+aIVC1BizGscZnHbRY-H8bgWlhE4vy9NNgKHDcjUjgdgSDaAtpqMCYLRQAfLFN6SVqYyAz172fVSKrSgw6r1toWog5YYOzFQLAkFQAAWBxUuxeSSlj2QtCaUrLDeQ6-sKS15tTNKvqqMotMFZY4aBcGfBk3OswwfPYy0sgeKyGk-lqPFo9dDgY4W5YdFQ7BUEDwoExY8mKbMYjxLdNRC5mSg-Lr0mBcUYOretiRbZMu37cbHl6j8a5m7Ott67phtBGDEunLlvs-DOBWB9JOjCi9oAeymIeBMFkXrSwUc678w3RaARXh7eke-NH64B7n8eJ1aXuzFNw0l9nZe539YjB7Jgpg1nOe623SeOc5qed58YcFlbJaFXVdwtzHes21XLw11M-GOXxAnCKsoCMMsq50GTn7HtBqx1vCyQh0TLia8WWZn5zoC7BQFAkOw4U0nsWgSk1LVBGQ4UyN-H+lgIY213j0A+UFTwwkAUAoI19Mx+w3KfZ4ul-yzEgcBNCC5vibgwcSP0XRvxs3vhkP+MgZAqw3kJdWyp+wdmIsDEeoAM6gESgXOh5QEp0BjD+JOLC2zLEDAXHeUg94QK-MfGEShEo9XTjCSK5BEIPGQptZgMUcF-GcIorCm0XTtlkPZSYY9jg3kSsjTKPl2p5VQgIgxMDYFAO0co12QNaoOM+BzShn0NG-ScTQFREobb+maNJC+fVDIgM6AGWGoASIACo-EBLiSRPQUSQmoyocSDCU1y7+wKrhA2TCwa2ntM4BubRlDFymtcE0ZoeRs3se4jxbwMkfTVhhJR-j8qbgKW8EOLD84xWLp05CG427GihGeXG-ImmWGXpYEZq40ktEbossZyylagGGsrIx4SHDDUoW0zeogMZ4KmWffGndFkEIDG3JQZz7wbIaYXBxxcHlDQqRM000IQLTJSrMoIwpGl1XmU7SUa0Npu3eoQLSzAiBsE4FAOAiBkDoCwAAJkyVvYmUhQSgk2q4b6DCKYOirKCB2FhL4eikLlH8oAABk9LQDkzEFIQJbNopRRiiS58uLDmfVmOEekRDQJhMnA4HFeKCU4IYSRIVngZDPXXt49wwq7kcpMIEXZ4rmWssCVWGgIq-mtM+iUh08qvDDQpaFHVMq5WqoVSkrZFSTXtNmAMW+zwxX9UlfinyMrcIkQ9Uq1WxyHBmv6N6IJhDrVgztcG1JwSZCurDdvJNmiPV0qKXs3VbKlAGqNXfFN1CEJYVQhq7VPqXBkr9YSn4sq1lJBDUcktjaPxPNFdmnVLK80FqUD2-VNLC0oN0l49pba86fJqZM+pnbK2GQHfmodS7DU-lHevFtWT0ESKgb8u+3rDK+ulUSwNGdRG-HeZxUAAAfa9TYj3+pPeeUi0gzJSFbA6S9xhb33urbi2tAbn2xPil+-l7T3k3OaFm+dtF02-UzYuvtxCMmfQg8NL5dS91eq7f1RDy6kOgXXaGktEaz0fneUoD1eh0PTu+asWNOa7VkYvTu4CTqqPOpmrRzDxat0uAjAaI03GfnQdBjmh9daelAblW6ITkI6MMGbd42T1Lyo+lxMs5B8oD3hvmNG258HvR6Dw6u5DY7U0CajNw2Mc6xPdr1Su78BHjW8a3hGyzcnakibKt6SqegZE6a+vWmTkZPMzrIE6nzFVMRAxkWB1NswQOsZgp2gAkFquzVbeVSsffWwNSWj67qU+0grQF8GZorZlwyGjrBEAYRgFDJW1aHzKxcKL6mtObECzVtaDD0WNdTaVyRq5EqicJox76ZTeu4WwANktpXnx0HFNHcjX4xuUpzaR+R56WvDanmlIbu7I2DAaW48GdpzUqeE48M7gRDvAVU75mLStbutWaxB0bZmN0CpcDkqsFd8m2Y2zqiTgHpmkT+3PYrqbqnycw+tsGJnh3ylc6IWYvN6Y433Thw9f6cuSdlRjtULRruKe-XewUoOn3g9iUT-miCm1zayXTmWplNo0BZp67TI842Tdq-VpnW8WcM2W1bKTfzDa899vz3C-XzMluF5EOWmIFZc66zzib0vptAdm-Fktsx4GT0DhSqlNbj31sDqRQ3Yhoclutwz2sC9dYyUsEURHDm+3G8F6IHus8AebjjibnNi7A-y6yTPB389A+S5zZ7xeYfsUuDNmoC21undBxjyDrI-90+GP4j9n2fu8kB8XpnrLZCnPLsD6jiVLgOHrZtVls3uXxcXNiRw23WSOFcJ4ZV8b9ne3LuIQn0QEb6+5I3Ax21RKSId9Sf94vNfdR0ixIyfEhJMEavS67qrtetHZBYCZFfDJcTr9ZLOiXP7Kd1434fnoGJV+n+ZBvlLfyR978UXf4-2In+NBf+c7DbfCwGDXUZvAnQNT-I-B-E-JkP-c-CLb3PfFkEEKA+kH-WA5A1-bHIAl5fvJvf9c3VvEYUiZAr-aA9As-NjRA0Ab-RkDtCXHHBwHrOrXCBrd-YgUue-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-h4PPvigrKEpalYe23bR4qwZ-i8cCR8eazoHXs3r0H8eakCbfB2x4dCZagipTyipylsr8BOryp5VBDbFvJJyycjO0GET6icZKfVIkfHSwhksbkSuiHkre1TXapUosqMFiqulTXKu0uvK6dTNhu-CMp-hMokDMs6uPDoFDPDKqdQg5i8qcp9pcpGZalCAcecEXUXKvJIeWm8tEV8pfL0ACp-IytSCchCsUjCuWfSdzLmdNLDEosSrIjIBSslDSoKpYiMjLUZyCteiHmyqKhYWbMKsTLUw6bOe2DBnKvqtbN7IsYO37J4cavbkhbXnRbXLafMozOvvIfYBMg4QLjKhTEAs1XeMikYhigwERMpdAHRURN4iVWLnxYSgEXKGOZZWcAKeiciA8eSC4iAA","body":"function assign_symbol_value(symbol, val, env) {\n    function env_loop(env) {\n        function scan(symbols, vals) {\n            return is_null(symbols)\n                   ? env_loop(enclosing_environment(env))\n                   : symbol === head(symbols)\n                   ? set_head(vals, val)\n                   : scan(tail(symbols), tail(vals));\n        } \n        if (env === the_empty_environment) {\n            error(symbol, \"unbound name -- assignment\");\n        } else {\n            const frame = first_frame(env);\n            return scan(frame_symbols(frame),\n                        frame_values(frame));\n        }\n    }\n    return env_loop(env);\n} "}]},{"tag":"TEXT","id":"#p11","child":[{"body":"\n    The method described here is only one of many plausible ways to represent\n    environments.  Since we used\n    \n    data abstraction to isolate the rest of the\n    evaluator from the detailed choice of representation, we could change the\n    environment representation if we wanted to.  (See\n    exercise ","tag":"#text"},{"tag":"REF","body":"4.9","href":"/sicpjs/4.1.3#ex-4.9"},{"body":".)  In a\n    production-quality\n    JavaScript\n    system, the speed of the evaluator's environment\n    operations—especially that of\n    symbol\n    lookup—has a major\n    impact on the performance of the system.  The representation described here,\n    although conceptually simple, is not efficient and would not ordinarily be\n    used in a production system.","tag":"#text"},{"tag":"FOOTNOTE_REF","id":"#footnote-link-3","body":"3","href":"/sicpjs/4.1.3#footnote-3"}]},{"tag":"EXERCISE","title":"Exercise 4.9","id":"#ex-4.9","child":[{"body":"\n    Instead of representing a frame as a pair of lists, we can represent a frame\n    as a list of bindings, where each binding is a symbol-value pair. Rewrite the\n    environment operations to use this alternative representation.            \n  ","tag":"#text"}]},{"tag":"EXERCISE","title":"Exercise 4.10","id":"#ex-4.10","child":[{"body":"\n    The\n    functions","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"lookup_symbol_value"},{"body":" and\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":"\n    can be expressed in terms of \n    a more abstract function\n    for traversing the environment structure. \n    \n\tDefine an abstraction that captures the common pattern and redefine the\n\ttwo functions in terms of this abstraction.\n      ","tag":"#text"}]},{"tag":"EXERCISE","title":"Exercise 4.11","id":"#ex-4.11","child":[{"body":"\n\tOur language distinguishes constants from variables by using \n\tdifferent keywords—","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"const"},{"body":"\n\tand ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"let"},{"body":"—and prevents\n\tassignment to constants. However, our interpreter\n\tdoes not make use of this distinction; the function\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":" will happily\n\tassign a new value to a given symbol, regardless whether it is declared\n\tas a constant or a variable.\n\t\n\tCorrect this flaw by calling the function\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"error"},{"body":" whenever an attempt is\n\tmade to use a constant on the left-hand side of an assignment.\n\tYou may proceed as follows:\n\t","tag":"#text"},{"tag":"UL","child":[{"tag":"LI","child":[{"body":"\n\t    Introduce predicates\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_constant_declaration"},{"body":"\n\t    and\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_variable_declaration"},{"body":"\n\t    that allow you to distinguish the two kinds. As shown in\n\t    section ","tag":"#text"},{"tag":"REF","body":"4.1.2","href":"/sicpjs/4.1.2"},{"body":",\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"parse"},{"body":" \n\t    distinguishes them by using the tags\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"\"constant_declaration\""},{"body":"\n\t    and\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"\"variable_declaration\""},{"body":".\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    Change \n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"scan_out_declarations"},{"body":"\n\t    and (if necessary)\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"extend_environment"},{"body":"\n\t    such that constants are distinguishable from variables in\n\t    the frames in which they are bound.\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    Change \n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":" such\n\t    that it checks whether the given symbol has been declared as\n\t    a variable or as a constant, and in the latter case signals\n\t    an error that assignment operations are not allowed on constants.\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    Change\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"eval_declaration"},{"body":"\n\t    such that when it encounters a constant declaration,\n\t    it calls a new function, \n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_constant_value"},{"body":", which\n\t    does not perform the check that you introduced in\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":".\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    If necessary, change\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"apply"},{"body":" to ensure that\n\t    assignment to function parameters remains possible.\n\t  ","tag":"#text"}]}]}]},{"tag":"EXERCISE","title":"Exercise 4.12","id":"#ex-4.12","child":[{"tag":"OL","child":[{"tag":"LI","child":[{"body":"\n\t    JavaScript's specification requires an implementation to\n\t    signal a runtime error upon an attempt to access the\n\t    value of a name before its declaration is evaluated (see\n\t    footnote ","tag":"#text"},{"tag":"REF","body":1,"href":"/sicpjs/3.2.4#footnote-1"},{"body":" in\n\t    section ","tag":"#text"},{"tag":"REF","body":"3.2.4","href":"/sicpjs/3.2.4"},{"body":").\n\t    To achieve this behavior in the evaluator,\n\t    \n\t    change ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"lookup_symbol_value"},{"body":"\n\t    to signal an error if the value it finds is\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"\"*unassigned*\""},{"body":".\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    Similarly, we must not assign a new value to a variable if\n\t    we have not evaluated its ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"let"},{"body":"\n\t    declaration yet. Change the evaluation of assignment\n\t    such that assignment to a variable declared with\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"let"},{"body":" signals an error\n\t    in this case.\n\t  ","tag":"#text"}]}]}]},{"tag":"EXERCISE","title":"Exercise 4.13","id":"#ex-4.13","child":[{"body":"\n\t  Prior to ECMAScript 2015's strict mode that we are using in this book,\n\t  JavaScript variables\n\t  worked quite differently from Scheme variables, which would have made\n\tthis adaptation to JavaScript considerably less compelling.\n\t","tag":"#text"},{"tag":"OL","child":[{"tag":"LI","child":[{"body":"\n\t    Before ECMAScript 2015, the only way to declare a local variable in\n\t    JavaScript was using the keyword\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"var"},{"body":"\n\t    instead of the keyword ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"let"},{"body":".\n\t    The scope of variables declared with\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"var"},{"body":" is the entire body of the\n\t    immediately surrounding function declaration or lambda expression,\n\t    rather than just the immediately enclosing block. Modify\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"scan_out_declarations"},{"body":" and \n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"eval_block"},{"body":" such that\n\t    names declared with ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"const"},{"body":" and\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"let"},{"body":" follow the scoping rules\n\t    of ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"var"},{"body":".\n\t  ","tag":"#text"}]},{"tag":"LI","child":[{"body":"\n\t    When not in strict mode, JavaScript permits undeclared\n\t    names to appear to the left of the\n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"="},{"body":" in assignments. \n\t    Such an assignment adds the new binding to the global\n\t    environment. Modify the function \n\t    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":"\n\t    to make assignment behave this way. The strict mode was introduced\n\t    in JavaScript in order to make programs more secure. What\n\t    security issue is addressed by removing the ability of assignment\n\t    to add bindings to the global environment?\n\t  ","tag":"#text"}]}]}]},{"tag":"DISPLAYFOOTNOTE","id":"#footnote-1","count":1,"href":"/sicpjs/4.1.3#footnote-link-1","child":[{"body":"Conditionals\n      in full JavaScript accept ","tag":"#text"},{"tag":"EM","child":[{"body":"any","tag":"#text"}]},{"body":" value, not just a boolean,\n      as the result of evaluating the\n\t\"predicate\" expression. JavaScript's notion of\n\ttruthiness and falsiness is captured by the following variants of \n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_truthy"},{"body":" and\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_falsy"},{"body":":\n\t","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":9,"eval":true,"prependLength":0,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQEY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0KAnIigCwE8AKAB4BKUAG9QbAKYUibegEIGLAgEMANo37CA3KAC+hUpVr0mzVRq0jRuUHYnTZ9PmYBGNGmskqSgkQDJ-UHkBUBF7CMjIgB9o2yiIlxYSIgBbV0k2P1BA0EFQAF4i0AAGUFjQUPli0KERWPiEuyTmRnYqEgBzbNzQooLQACJB8KaIhrG7MxS1NWzJhaaJybNSABNJAg7JNb9tXD0gA","body":"function is_truthy(x) { return ! is_falsy(x); }\nfunction is_falsy(x) {\n    return (is_boolean(x) && !x )                  ||\n           (is_number(x) && (x === 0 || x !== x )) ||\n           (is_string(x) && x === \"\")              ||\n           is_null(x)                              ||\n           is_undefined(x);\n} "},{"body":"\n\tThe test ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"x !== x"},{"body":" is not a typo;\n\tthe only JavaScript value for which\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"x !== x"},{"body":" yields true is the value\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"NaN"},{"body":" (\"Not a Number\"),\n\t\n\twhich is considered to be a falsy number (also not a typo), along with 0.\n\tThe numerical value\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"NaN"},{"body":" is the result of certain\n\tarithmetic border cases such as\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"0 / 0"},{"body":".\n\t","tag":"#text"},{"tag":"TEXT","id":"#p12","child":[{"body":"\n\t  The terms \"truthy\" and \"falsy\" were coined\n\t  by\n\t  \n\t  Douglas Crockford, one of whose books\n\t  (Crockford 2008) inspired this JavaScript adaptation.\n\t","tag":"#text"}]}]},{"tag":"DISPLAYFOOTNOTE","id":"#footnote-2","count":2,"href":"/sicpjs/4.1.3#footnote-link-2","child":[{"body":"Frames are not really a data\n    \n\tabstraction:\n      \n\tThe function\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"assign_symbol_value"},{"body":"\n\tbelow uses\n\t","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"set_head"},{"body":"\n\tto directly modify the values in a frame.\n      \n    The purpose of the frame\n    functions\n    is to make the environment-manipulation\n    functions\n    easy to read.","tag":"#text"}]},{"tag":"DISPLAYFOOTNOTE","id":"#footnote-3","count":3,"href":"/sicpjs/4.1.3#footnote-link-3","child":[{"body":"The drawback of this representation (as\n    well as the variant in\n    exercise ","tag":"#text"},{"tag":"REF","body":"4.9","href":"/sicpjs/4.1.3#ex-4.9"},{"body":") is that the\n    evaluator may have to search through many frames in order to find the binding\n    for a given variable.\n    (Such an approach is referred to as\n    ","tag":"#text"},{"tag":"EM","child":[{"body":"deep binding","tag":"#text"}]},{"body":".) One way to avoid\n    this inefficiency is to make use of a strategy called\n\t","tag":"#text"},{"tag":"EM","child":[{"body":"lexical addressing","tag":"#text"}]},{"body":", which will be discussed in\n\tsection ","tag":"#text"},{"tag":"REF","body":"5.5.6","href":"/sicpjs/5.5.6"},{"body":".\n  ","tag":"#text"}]}]